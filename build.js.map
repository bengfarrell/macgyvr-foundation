{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/macgyvr/src/basegroup.js","node_modules/macgyvr/src/plugins/tween.js","node_modules/macgyvr/src/utils/color.js","src/main.js","src/objects/cube.js","src/objects/testscene.js"],"names":[],"mappings":"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","file":"build.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","export default class BaseGroup {\n    constructor(params) {\n\n        /**\n         * parent group of child objects we will create\n         * @type {THREE.Object3D}\n         * @private\n         */\n        this._group = new THREE.Object3D();\n\n        /** additional render hooks we can add */\n        this._renderHooks = [];\n\n        this._config = params;\n        this.onInitialize(params);\n    }\n\n    /**\n     * get name of group\n     */\n    get name() {\n        return this.constructor.name;\n    }\n\n    /**\n     * overridable methods\n     * leave empty to be a simple abstraction we don't have to call super on\n     * @param scene\n     */\n    onCreate(scene) {};\n    onRender(scene, time) {};\n    onInitialize(params) {};\n    onAssetsLoaded(geometry, material) {};\n    onJSONSceneLoadProgress(progress) {};\n    onJSONSceneLoadError(err) {};\n    onJSONSceneLoaded(scene) { this.add(scene) };\n\n    /**\n     * on create scene (or earliest possible opportunity)\n     * @param scene\n     */\n    create(scene) {\n        this._group.name = this.name;\n        this._sceneCollection = scene;\n        scene.scene.add(this._group);\n\n        if (this._config && this._config.assets) {\n            // todo: determine when to use JSON Loader, OBJ loader, or whatever\n            var loader = new THREE.JSONLoader();\n            loader.load(this._config.assets, (geometry, materials) => {\n                this.onAssetsLoaded(geometry, materials);\n            });\n        }\n\n        if (this._config && this._config.scene) {\n            // todo: determine when to use JSON Loader, OBJ loader, or whatever\n            var loader = new THREE.ObjectLoader();\n            loader.load(this._config.scene, (loaded) => {\n                this.onJSONSceneLoaded(loaded);\n            }, (progress) => {\n                this.onJSONSceneLoadProgress(progress);\n            }, (err) => {\n                this.onJSONSceneLoadError(err);\n            });\n        }\n\n        this.onCreate();\n    }\n\n    /**\n     * add object to scene\n     * @param object\n     */\n    add(object, name) {\n        if (!name) {\n            name = this.name + '-child';\n        }\n        object.name = name;\n        this._group.add(object);\n    }\n\n    addRenderHook(method) {\n        this._renderHooks.push(method);\n    }\n\n    /**\n     * get parent group object\n     * @returns {THREE.Object3D}\n     */\n    get group() {\n        return this._group;\n    }\n\n    /**\n     * get scene\n     * @returns {THREE.Object3D}\n     */\n    get sceneCollection() {\n        return this._sceneCollection;\n    }\n\n    /**\n     * get children of this group\n     * @returns {Array}\n     */\n    get children() {\n        return this._group.children;\n    }\n\n    /**\n     * on prerender scene\n     * @param scene\n     */\n    preRender() {}\n\n    /**\n     * on render scene\n     * @param time\n     */\n    render(time) {\n        for (var c = 0; c < this._renderHooks.length; c++) {\n            this._renderHooks[c].apply(this, [time]);\n        }\n        this.onRender(time);\n    }\n}\n","import Color from '../utils/color.js';\n\nexport default class Tween {\n    constructor(group) {\n        if (!createjs) {\n            throw new Error('CreateJS Tween must be included in your build or linked via script to animate');\n            return;\n        }\n        group.addRenderHook( (scene, time) => this.onRender(scene, time));\n        this.animations = [];\n    }\n\n    /**\n     * animate THREE.js mesh position property\n     * @param {int} from\n     * @param {int} to\n     * @param options\n     */\n    animateColor(from, to, options) {\n        if (typeof from !== 'object') {\n            if (typeof from !== 'number' && from.charAt(0) === '#') {\n                from = Number('0x' + from.substr(1, from.length));\n                from = Color.decToRGB(from);\n            } else {\n                from = Color.decToRGB(from);\n            }\n        }\n\n        if (typeof to !== 'object') {\n            if (typeof to !== 'number' && to.charAt(0) === '#') {\n                to = Number('0x' + to.substr(1, to.length));\n                to = Color.decToRGB(to);\n            } else {\n                to = Color.decToRGB(to);\n            }\n        }\n\n        from = this.populateStartAnimationObject(from, options);\n        from.animation.step.push( (step) => this.animateColorStep(step));\n        this.createTween(to, from, options);\n        this.animations.push(from);\n    }\n\n    /**\n     * animate THREE.js mesh position property\n     * @param {Three.js Vector3} from\n     * @param {Three.js Vector3} to\n     * @param options\n     */\n    animatePosition(from, to, options) {\n        from = { x: from.x, y: from.y, z: from.z };\n        to = { x: to.x, y: to.y, z: to.z };\n        from = this.populateStartAnimationObject(from, options);\n        from.animation.step.push( (step) => this.animatePositionStep(step));\n        this.createTween(to, from, options);\n        this.animations.push(from);\n    }\n\n    /**\n     * create and start animation\n     * @param from\n     * @param to\n     * @param options\n     */\n    animate(from, to, options) {\n        if (!createjs) {\n            throw new Error('CreateJS Tween must be included in your build or linked via script to animate');\n            return;\n        }\n\n        if (!options.step) {\n            throw new Error('Please define a \"step\" property on options to specify a callback for each animation update');\n        }\n\n        from = this.populateStartAnimationObject(from, to);\n        this.createTween(to, from, options);\n        this.animations.push(from);\n    }\n\n    /**\n     * populate animation start object\n     * @param from\n     * @param options\n     * @returns {*}\n     */\n    populateStartAnimationObject(from, options) {\n        from.animation = {};\n        from.animation.animating = true;\n        from.animation.step = [];\n        if (options.step) {\n            from.animation.step.push(options.step);\n        }\n        from.animation.target = options.target;\n        from.animation.loop = options.loop;\n        from.animation.complete = options.complete;\n        return from;\n    }\n\n    /**\n     * create tween\n     * @param to\n     * @param from\n     * @param options\n     * @returns {Tween}\n     */\n    createTween(to, from, options) {\n        createjs.Tween.get(from, options)\n            .to(to, options.duration)\n            .call( function() {\n                if (!this._loop) {\n                    this.animation.animating = false;\n                }\n                if (this.animation.complete) {\n                    this.animation.complete.apply(this, [this]);\n                }\n            });\n    }\n\n    /**\n     * animate step for Three.JS position\n     * @param step\n     */\n    animatePositionStep(step) {\n        step.animation.target.position.set(step.x, step.y, step.z);\n    }\n\n    /**\n     * animate step for Three.JS material color\n     * @param step\n     */\n    animateColorStep(step) {\n        step.animation.target.material.color.setRGB(step.r/255, step.g/255, step.b/255);\n    }\n\n    /**\n     * animate render hook\n     * @param time\n     * @param scene\n     */\n    onRender(scene, time) {\n        var running = [];\n        for (var c = 0; c < this.animations.length; c++) {\n            if (this.animations[c].animation.animating) {\n                running.push(this.animations[c]);\n                for (var d = 0; d < this.animations[c].animation.step.length; d++) {\n                    this.animations[c].animation.step[d].apply(this, [this.animations[c]]);\n                }\n            }\n        }\n        this.animations = running;\n    }\n}\n","export default {\n    /**\n     * turn decimal color to RGB\n     * @param dec\n     * @returns {{r: number, g: number, b: number}}\n     */\n    decToRGB(dec) {\n        var r = (dec >> 16) & 0xff;\n        var g = (dec >> 8)  & 0xff;\n        var b = dec & 0xff;\n        return { r: r, g: g, b: b };\n    },\n\n    RGBToDec(rgb) {\n        return rgb.r << 16 + rgb.g << 16 + rgb.b;\n    }\n}\n","import Cube from './objects/cube.js';\nimport TestScene from './objects/testscene.js';\n\nexport default class Main {\n    constructor(scene) {\n        scene.onPreRender = this.render;\n\n        scene.addObjects([\n            new Cube(),\n            new TestScene({ scene: './src/assets/tempscene.json' })\n        ]);\n    }\n\n    render(time) {\n    }\n}\n","import BaseGroup from '../../node_modules/macgyvr/src/basegroup.js';\nimport Tween from '../../node_modules/macgyvr/src/plugins/tween.js';\n\nexport default class Cube extends BaseGroup {\n    /**\n     * on create scene (or earliest possible opportunity)\n     * @param scene\n     */\n    onCreate() {\n        this._material = this.createMaterial();\n        var mesh = new THREE.Mesh(this.createGeometry(), this._material);\n        this.add(mesh, 'cube');\n        this.group.position.z = -20;\n        this.tweener = new Tween(this);\n\n        document.addEventListener('keyup', (event) => {\n            if (event.keyCode === 32) {\n                var props = {\n                    target: mesh,\n                    duration: 3000\n                };\n                this.tweener.animateColor( 0xff0000, 0x00ff00, props );\n                this.tweener.animatePosition( new THREE.Vector3(0,0,0), new THREE.Vector3(10,6,3), props );\n            }\n        });\n    }\n\n    /**\n     * on render\n     * @param time\n     */\n    onRender(time) {\n        this.group.rotation.y += .01;\n    }\n\n    /**\n     * create globe geometry\n     * @returns {THREE.IcosahedronGeometry}\n     */\n    createGeometry() {\n        return new THREE.CubeGeometry(5, 5, 5, 10, 10);\n    }\n\n    /**\n     * create globe material\n     */\n    createMaterial() {\n        return new THREE.MeshPhongMaterial({\n            color      :  0xff0000,\n            shininess  :  10,\n            shading    :  THREE.FlatShading,\n            transparent: true,\n            opacity    : 1\n        });\n    }\n}\n","import BaseGroup from '../../node_modules/macgyvr/src/basegroup.js';\n\nexport default class TestScene extends BaseGroup {\n    /**\n     * on create scene (or earliest possible opportunity)\n     */\n    onCreate() {\n    }\n\n    onJSONSceneLoaded(scene) {\n        super.onJSONSceneLoaded(scene);\n        this._cube = scene.getObjectByName('Box 1');\n        this._sphere = scene.getObjectByName('Sphere 2');\n    };\n\n    /**\n     * on render\n     * @param time\n     */\n    onRender(time) {\n    }\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvbWFjZ3l2ci9zcmMvYmFzZWdyb3VwLmpzIiwibm9kZV9tb2R1bGVzL21hY2d5dnIvc3JjL3BsdWdpbnMvdHdlZW4uanMiLCJub2RlX21vZHVsZXMvbWFjZ3l2ci9zcmMvdXRpbHMvY29sb3IuanMiLCJzcmMvbWFpbi5qcyIsInNyYy9vYmplY3RzL2N1YmUuanMiLCJzcmMvb2JqZWN0cy90ZXN0c2NlbmUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7O0lDQXFCLFM7QUFDakIsdUJBQVksTUFBWixFQUFvQjtBQUFBOztBQUVoQjs7Ozs7QUFLQSxhQUFLLE1BQUwsR0FBYyxJQUFJLE1BQU0sUUFBVixFQUFkOztBQUVBO0FBQ0EsYUFBSyxZQUFMLEdBQW9CLEVBQXBCOztBQUVBLGFBQUssT0FBTCxHQUFlLE1BQWY7QUFDQSxhQUFLLFlBQUwsQ0FBa0IsTUFBbEI7QUFDSDs7QUFFRDs7Ozs7Ozs7O0FBT0E7Ozs7O2lDQUtTLEssRUFBTyxDQUFFOzs7aUNBQ1QsSyxFQUFPLEksRUFBTSxDQUFFOzs7cUNBQ1gsTSxFQUFRLENBQUU7Ozt1Q0FDUixRLEVBQVUsUSxFQUFVLENBQUU7OztnREFDYixRLEVBQVUsQ0FBRTs7OzZDQUNmLEcsRUFBSyxDQUFFOzs7MENBQ1YsSyxFQUFPO0FBQUUsaUJBQUssR0FBTCxDQUFTLEtBQVQ7QUFBaUI7Ozs7O0FBRTVDOzs7OytCQUlPLEssRUFBTztBQUFBOztBQUNWLGlCQUFLLE1BQUwsQ0FBWSxJQUFaLEdBQW1CLEtBQUssSUFBeEI7QUFDQSxpQkFBSyxnQkFBTCxHQUF3QixLQUF4QjtBQUNBLGtCQUFNLEtBQU4sQ0FBWSxHQUFaLENBQWdCLEtBQUssTUFBckI7O0FBRUEsZ0JBQUksS0FBSyxPQUFMLElBQWdCLEtBQUssT0FBTCxDQUFhLE1BQWpDLEVBQXlDO0FBQ3JDO0FBQ0Esb0JBQUksU0FBUyxJQUFJ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LEFBQ2I7eUJBTEosQUFBTyxBQUE0QixBQUtsQixBQUVwQjtBQVBzQyxBQUMvQixhQURHOzs7Ozs7O2tCLEFBNUNNOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDSHJCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJLEFBRXFCOzs7Ozs7Ozs7O1NBQ2pCOzs7OzsrQkFHVyxBQUNWOzs7c0MsQUFFaUIsT0FBTyxBQUNyQjs4SEFBQSxBQUF3QixBQUN4QjtXQUFBLEFBQUssUUFBUSxNQUFBLEFBQU0sZ0JBQW5CLEFBQWEsQUFBc0IsQUFDbkM7V0FBQSxBQUFLLFVBQVUsTUFBQSxBQUFNLGdCQUFyQixBQUFlLEFBQXNCLEFBQ3hDOzs7U0FFRDs7Ozs7OzZCLEFBSVMsTUFBTSxBQUNkOzs7Ozs7a0IsQUFsQmdCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhc2VHcm91cCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1zKSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHBhcmVudCBncm91cCBvZiBjaGlsZCBvYmplY3RzIHdlIHdpbGwgY3JlYXRlXG4gICAgICAgICAqIEB0eXBlIHtUSFJFRS5PYmplY3QzRH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2dyb3VwID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG5cbiAgICAgICAgLyoqIGFkZGl0aW9uYWwgcmVuZGVyIGhvb2tzIHdlIGNhbiBhZGQgKi9cbiAgICAgICAgdGhpcy5fcmVuZGVySG9va3MgPSBbXTtcblxuICAgICAgICB0aGlzLl9jb25maWcgPSBwYXJhbXM7XG4gICAgICAgIHRoaXMub25Jbml0aWFsaXplKHBhcmFtcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZ2V0IG5hbWUgb2YgZ3JvdXBcbiAgICAgKi9cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IubmFtZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBvdmVycmlkYWJsZSBtZXRob2RzXG4gICAgICogbGVhdmUgZW1wdHkgdG8gYmUgYSBzaW1wbGUgYWJzdHJhY3Rpb24gd2UgZG9uJ3QgaGF2ZSB0byBjYWxsIHN1cGVyIG9uXG4gICAgICogQHBhcmFtIHNjZW5lXG4gICAgICovXG4gICAgb25DcmVhdGUoc2NlbmUpIHt9O1xuICAgIG9uUmVuZGVyKHNjZW5lLCB0aW1lKSB7fTtcbiAgICBvbkluaXRpYWxpemUocGFyYW1zKSB7fTtcbiAgICBvbkFzc2V0c0xvYWRlZChnZW9tZXRyeSwgbWF0ZXJpYWwpIHt9O1xuICAgIG9uSlNPTlNjZW5lTG9hZFByb2dyZXNzKHByb2dyZXNzKSB7fTtcbiAgICBvbkpTT05TY2VuZUxvYWRFcnJvcihlcnIpIHt9O1xuICAgIG9uSlNPTlNjZW5lTG9hZGVkKHNjZW5lKSB7IHRoaXMuYWRkKHNjZW5lKSB9O1xuXG4gICAgLyoqXG4gICAgICogb24gY3JlYXRlIHNjZW5lIChvciBlYXJsaWVzdCBwb3NzaWJsZSBvcHBvcnR1bml0eSlcbiAgICAgKiBAcGFyYW0gc2NlbmVcbiAgICAgKi9cbiAgICBjcmVhdGUoc2NlbmUpIHtcbiAgICAgICAgdGhpcy5fZ3JvdXAubmFtZSA9IHRoaXMubmFtZTtcbiAgICAgICAgdGhpcy5fc2NlbmVDb2xsZWN0aW9uID0gc2NlbmU7XG4gICAgICAgIHNjZW5lLnNjZW5lLmFkZCh0aGlzLl9ncm91cCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2NvbmZpZyAmJiB0aGlzLl9jb25maWcuYXNzZXRzKSB7XG4gICAgICAgICAgICAvLyB0b2RvOiBkZXRlcm1pbmUgd2hlbiB0byB1c2UgSlNPTiBMb2FkZXIsIE9CSiBsb2FkZXIsIG9yIHdoYXRldmVyXG4gICAgICAgICAgICB2YXIgbG9hZGVyID0gbmV3IFRIUkVFLkpTT05Mb2FkZXIoKTtcbiAgICAgICAgICAgIGxvYWRlci5sb2FkKHRoaXMuX2NvbmZpZy5hc3NldHMsIChnZW9tZXRyeSwgbWF0ZXJpYWxzKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkFzc2V0c0xvYWRlZChnZW9tZXRyeSwgbWF0ZXJpYWxzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2NvbmZpZyAmJiB0aGlzLl9jb25maWcuc2NlbmUpIHtcbiAgICAgICAgICAgIC8vIHRvZG86IGRldGVybWluZSB3aGVuIHRvIHVzZSBKU09OIExvYWRlciwgT0JKIGxvYWRlciwgb3Igd2hhdGV2ZXJcbiAgICAgICAgICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuT2JqZWN0TG9hZGVyKCk7XG4gICAgICAgICAgICBsb2FkZXIubG9hZCh0aGlzLl9jb25maWcuc2NlbmUsIChsb2FkZWQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uSlNPTlNjZW5lTG9hZGVkKGxvYWRlZCk7XG4gICAgICAgICAgICB9LCAocHJvZ3Jlc3MpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uSlNPTlNjZW5lTG9hZFByb2dyZXNzKHByb2dyZXNzKTtcbiAgICAgICAgICAgIH0sIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uSlNPTlNjZW5lTG9hZEVycm9yKGVycik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub25DcmVhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBhZGQgb2JqZWN0IHRvIHNjZW5lXG4gICAgICogQHBhcmFtIG9iamVjdFxuICAgICAqL1xuICAgIGFkZChvYmplY3QsIG5hbWUpIHtcbiAgICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgICAgICBuYW1lID0gdGhpcy5uYW1lICsgJy1jaGlsZCc7XG4gICAgICAgIH1cbiAgICAgICAgb2JqZWN0Lm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLl9ncm91cC5hZGQob2JqZWN0KTtcbiAgICB9XG5cbiAgICBhZGRSZW5kZXJIb29rKG1ldGhvZCkge1xuICAgICAgICB0aGlzLl9yZW5kZXJIb29rcy5wdXNoKG1ldGhvZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZ2V0IHBhcmVudCBncm91cCBvYmplY3RcbiAgICAgKiBAcmV0dXJucyB7VEhSRUUuT2JqZWN0M0R9XG4gICAgICovXG4gICAgZ2V0IGdyb3VwKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ3JvdXA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZ2V0IHNjZW5lXG4gICAgICogQHJldHVybnMge1RIUkVFLk9iamVjdDNEfVxuICAgICAqL1xuICAgIGdldCBzY2VuZUNvbGxlY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zY2VuZUNvbGxlY3Rpb247XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZ2V0IGNoaWxkcmVuIG9mIHRoaXMgZ3JvdXBcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICovXG4gICAgZ2V0IGNoaWxkcmVuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ3JvdXAuY2hpbGRyZW47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogb24gcHJlcmVuZGVyIHNjZW5lXG4gICAgICogQHBhcmFtIHNjZW5lXG4gICAgICovXG4gICAgcHJlUmVuZGVyKCkge31cblxuICAgIC8qKlxuICAgICAqIG9uIHJlbmRlciBzY2VuZVxuICAgICAqIEBwYXJhbSB0aW1lXG4gICAgICovXG4gICAgcmVuZGVyKHRpbWUpIHtcbiAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB0aGlzLl9yZW5kZXJIb29rcy5sZW5ndGg7IGMrKykge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVySG9va3NbY10uYXBwbHkodGhpcywgW3RpbWVdKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uUmVuZGVyKHRpbWUpO1xuICAgIH1cbn1cbiIsImltcG9ydCBDb2xvciBmcm9tICcuLi91dGlscy9jb2xvci5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFR3ZWVuIHtcbiAgICBjb25zdHJ1Y3Rvcihncm91cCkge1xuICAgICAgICBpZiAoIWNyZWF0ZWpzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyZWF0ZUpTIFR3ZWVuIG11c3QgYmUgaW5jbHVkZWQgaW4geW91ciBidWlsZCBvciBsaW5rZWQgdmlhIHNjcmlwdCB0byBhbmltYXRlJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZ3JvdXAuYWRkUmVuZGVySG9vayggKHNjZW5lLCB0aW1lKSA9PiB0aGlzLm9uUmVuZGVyKHNjZW5lLCB0aW1lKSk7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9ucyA9IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFuaW1hdGUgVEhSRUUuanMgbWVzaCBwb3NpdGlvbiBwcm9wZXJ0eVxuICAgICAqIEBwYXJhbSB7aW50fSBmcm9tXG4gICAgICogQHBhcmFtIHtpbnR9IHRvXG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBhbmltYXRlQ29sb3IoZnJvbSwgdG8sIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmcm9tICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmcm9tICE9PSAnbnVtYmVyJyAmJiBmcm9tLmNoYXJBdCgwKSA9PT0gJyMnKSB7XG4gICAgICAgICAgICAgICAgZnJvbSA9IE51bWJlcignMHgnICsgZnJvbS5zdWJzdHIoMSwgZnJvbS5sZW5ndGgpKTtcbiAgICAgICAgICAgICAgICBmcm9tID0gQ29sb3IuZGVjVG9SR0IoZnJvbSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZyb20gPSBDb2xvci5kZWNUb1JHQihmcm9tKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgdG8gIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRvICE9PSAnbnVtYmVyJyAmJiB0by5jaGFyQXQoMCkgPT09ICcjJykge1xuICAgICAgICAgICAgICAgIHRvID0gTnVtYmVyKCcweCcgKyB0by5zdWJzdHIoMSwgdG8ubGVuZ3RoKSk7XG4gICAgICAgICAgICAgICAgdG8gPSBDb2xvci5kZWNUb1JHQih0byk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvID0gQ29sb3IuZGVjVG9SR0IodG8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnJvbSA9IHRoaXMucG9wdWxhdGVTdGFydEFuaW1hdGlvbk9iamVjdChmcm9tLCBvcHRpb25zKTtcbiAgICAgICAgZnJvbS5hbmltYXRpb24uc3RlcC5wdXNoKCAoc3RlcCkgPT4gdGhpcy5hbmltYXRlQ29sb3JTdGVwKHN0ZXApKTtcbiAgICAgICAgdGhpcy5jcmVhdGVUd2Vlbih0bywgZnJvbSwgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9ucy5wdXNoKGZyb20pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFuaW1hdGUgVEhSRUUuanMgbWVzaCBwb3NpdGlvbiBwcm9wZXJ0eVxuICAgICAqIEBwYXJhbSB7VGhyZWUuanMgVmVjdG9yM30gZnJvbVxuICAgICAqIEBwYXJhbSB7VGhyZWUuanMgVmVjdG9yM30gdG9cbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuICAgIGFuaW1hdGVQb3NpdGlvbihmcm9tLCB0bywgb3B0aW9ucykge1xuICAgICAgICBmcm9tID0geyB4OiBmcm9tLngsIHk6IGZyb20ueSwgejogZnJvbS56IH07XG4gICAgICAgIHRvID0geyB4OiB0by54LCB5OiB0by55LCB6OiB0by56IH07XG4gICAgICAgIGZyb20gPSB0aGlzLnBvcHVsYXRlU3RhcnRBbmltYXRpb25PYmplY3QoZnJvbSwgb3B0aW9ucyk7XG4gICAgICAgIGZyb20uYW5pbWF0aW9uLnN0ZXAucHVzaCggKHN0ZXApID0+IHRoaXMuYW5pbWF0ZVBvc2l0aW9uU3RlcChzdGVwKSk7XG4gICAgICAgIHRoaXMuY3JlYXRlVHdlZW4odG8sIGZyb20sIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmFuaW1hdGlvbnMucHVzaChmcm9tKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjcmVhdGUgYW5kIHN0YXJ0IGFuaW1hdGlvblxuICAgICAqIEBwYXJhbSBmcm9tXG4gICAgICogQHBhcmFtIHRvXG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBhbmltYXRlKGZyb20sIHRvLCBvcHRpb25zKSB7XG4gICAgICAgIGlmICghY3JlYXRlanMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ3JlYXRlSlMgVHdlZW4gbXVzdCBiZSBpbmNsdWRlZCBpbiB5b3VyIGJ1aWxkIG9yIGxpbmtlZCB2aWEgc2NyaXB0IHRvIGFuaW1hdGUnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghb3B0aW9ucy5zdGVwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BsZWFzZSBkZWZpbmUgYSBcInN0ZXBcIiBwcm9wZXJ0eSBvbiBvcHRpb25zIHRvIHNwZWNpZnkgYSBjYWxsYmFjayBmb3IgZWFjaCBhbmltYXRpb24gdXBkYXRlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmcm9tID0gdGhpcy5wb3B1bGF0ZVN0YXJ0QW5pbWF0aW9uT2JqZWN0KGZyb20sIHRvKTtcbiAgICAgICAgdGhpcy5jcmVhdGVUd2Vlbih0bywgZnJvbSwgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9ucy5wdXNoKGZyb20pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHBvcHVsYXRlIGFuaW1hdGlvbiBzdGFydCBvYmplY3RcbiAgICAgKiBAcGFyYW0gZnJvbVxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgcG9wdWxhdGVTdGFydEFuaW1hdGlvbk9iamVjdChmcm9tLCBvcHRpb25zKSB7XG4gICAgICAgIGZyb20uYW5pbWF0aW9uID0ge307XG4gICAgICAgIGZyb20uYW5pbWF0aW9uLmFuaW1hdGluZyA9IHRydWU7XG4gICAgICAgIGZyb20uYW5pbWF0aW9uLnN0ZXAgPSBbXTtcbiAgICAgICAgaWYgKG9wdGlvbnMuc3RlcCkge1xuICAgICAgICAgICAgZnJvbS5hbmltYXRpb24uc3RlcC5wdXNoKG9wdGlvbnMuc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgZnJvbS5hbmltYXRpb24udGFyZ2V0ID0gb3B0aW9ucy50YXJnZXQ7XG4gICAgICAgIGZyb20uYW5pbWF0aW9uLmxvb3AgPSBvcHRpb25zLmxvb3A7XG4gICAgICAgIGZyb20uYW5pbWF0aW9uLmNvbXBsZXRlID0gb3B0aW9ucy5jb21wbGV0ZTtcbiAgICAgICAgcmV0dXJuIGZyb207XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY3JlYXRlIHR3ZWVuXG4gICAgICogQHBhcmFtIHRvXG4gICAgICogQHBhcmFtIGZyb21cbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqIEByZXR1cm5zIHtUd2Vlbn1cbiAgICAgKi9cbiAgICBjcmVhdGVUd2Vlbih0bywgZnJvbSwgb3B0aW9ucykge1xuICAgICAgICBjcmVhdGVqcy5Ud2Vlbi5nZXQoZnJvbSwgb3B0aW9ucylcbiAgICAgICAgICAgIC50byh0bywgb3B0aW9ucy5kdXJhdGlvbilcbiAgICAgICAgICAgIC5jYWxsKCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2xvb3ApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb24uYW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbi5jb21wbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbi5jb21wbGV0ZS5hcHBseSh0aGlzLCBbdGhpc10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFuaW1hdGUgc3RlcCBmb3IgVGhyZWUuSlMgcG9zaXRpb25cbiAgICAgKiBAcGFyYW0gc3RlcFxuICAgICAqL1xuICAgIGFuaW1hdGVQb3NpdGlvblN0ZXAoc3RlcCkge1xuICAgICAgICBzdGVwLmFuaW1hdGlvbi50YXJnZXQucG9zaXRpb24uc2V0KHN0ZXAueCwgc3RlcC55LCBzdGVwLnopO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFuaW1hdGUgc3RlcCBmb3IgVGhyZWUuSlMgbWF0ZXJpYWwgY29sb3JcbiAgICAgKiBAcGFyYW0gc3RlcFxuICAgICAqL1xuICAgIGFuaW1hdGVDb2xvclN0ZXAoc3RlcCkge1xuICAgICAgICBzdGVwLmFuaW1hdGlvbi50YXJnZXQubWF0ZXJpYWwuY29sb3Iuc2V0UkdCKHN0ZXAuci8yNTUsIHN0ZXAuZy8yNTUsIHN0ZXAuYi8yNTUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFuaW1hdGUgcmVuZGVyIGhvb2tcbiAgICAgKiBAcGFyYW0gdGltZVxuICAgICAqIEBwYXJhbSBzY2VuZVxuICAgICAqL1xuICAgIG9uUmVuZGVyKHNjZW5lLCB0aW1lKSB7XG4gICAgICAgIHZhciBydW5uaW5nID0gW107XG4gICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgdGhpcy5hbmltYXRpb25zLmxlbmd0aDsgYysrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb25zW2NdLmFuaW1hdGlvbi5hbmltYXRpbmcpIHtcbiAgICAgICAgICAgICAgICBydW5uaW5nLnB1c2godGhpcy5hbmltYXRpb25zW2NdKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gMDsgZCA8IHRoaXMuYW5pbWF0aW9uc1tjXS5hbmltYXRpb24uc3RlcC5sZW5ndGg7IGQrKykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnNbY10uYW5pbWF0aW9uLnN0ZXBbZF0uYXBwbHkodGhpcywgW3RoaXMuYW5pbWF0aW9uc1tjXV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFuaW1hdGlvbnMgPSBydW5uaW5nO1xuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IHtcbiAgICAvKipcbiAgICAgKiB0dXJuIGRlY2ltYWwgY29sb3IgdG8gUkdCXG4gICAgICogQHBhcmFtIGRlY1xuICAgICAqIEByZXR1cm5zIHt7cjogbnVtYmVyLCBnOiBudW1iZXIsIGI6IG51bWJlcn19XG4gICAgICovXG4gICAgZGVjVG9SR0IoZGVjKSB7XG4gICAgICAgIHZhciByID0gKGRlYyA+PiAxNikgJiAweGZmO1xuICAgICAgICB2YXIgZyA9IChkZWMgPj4gOCkgICYgMHhmZjtcbiAgICAgICAgdmFyIGIgPSBkZWMgJiAweGZmO1xuICAgICAgICByZXR1cm4geyByOiByLCBnOiBnLCBiOiBiIH07XG4gICAgfSxcblxuICAgIFJHQlRvRGVjKHJnYikge1xuICAgICAgICByZXR1cm4gcmdiLnIgPDwgMTYgKyByZ2IuZyA8PCAxNiArIHJnYi5iO1xuICAgIH1cbn1cbiIsImltcG9ydCBDdWJlIGZyb20gJy4vb2JqZWN0cy9jdWJlLmpzJztcbmltcG9ydCBUZXN0U2NlbmUgZnJvbSAnLi9vYmplY3RzL3Rlc3RzY2VuZS5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1haW4ge1xuICAgIGNvbnN0cnVjdG9yKHNjZW5lKSB7XG4gICAgICAgIHNjZW5lLm9uUHJlUmVuZGVyID0gdGhpcy5yZW5kZXI7XG5cbiAgICAgICAgc2NlbmUuYWRkT2JqZWN0cyhbXG4gICAgICAgICAgICBuZXcgQ3ViZSgpLFxuICAgICAgICAgICAgbmV3IFRlc3RTY2VuZSh7IHNjZW5lOiAnLi9zcmMvYXNzZXRzL3RlbXBzY2VuZS5qc29uJyB9KVxuICAgICAgICBdKTtcbiAgICB9XG5cbiAgICByZW5kZXIodGltZSkge1xuICAgIH1cbn1cbiIsImltcG9ydCBCYXNlR3JvdXAgZnJvbSAnLi4vLi4vbm9kZV9tb2R1bGVzL21hY2d5dnIvc3JjL2Jhc2Vncm91cC5qcyc7XG5pbXBvcnQgVHdlZW4gZnJvbSAnLi4vLi4vbm9kZV9tb2R1bGVzL21hY2d5dnIvc3JjL3BsdWdpbnMvdHdlZW4uanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDdWJlIGV4dGVuZHMgQmFzZUdyb3VwIHtcbiAgICAvKipcbiAgICAgKiBvbiBjcmVhdGUgc2NlbmUgKG9yIGVhcmxpZXN0IHBvc3NpYmxlIG9wcG9ydHVuaXR5KVxuICAgICAqIEBwYXJhbSBzY2VuZVxuICAgICAqL1xuICAgIG9uQ3JlYXRlKCkge1xuICAgICAgICB0aGlzLl9tYXRlcmlhbCA9IHRoaXMuY3JlYXRlTWF0ZXJpYWwoKTtcbiAgICAgICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCh0aGlzLmNyZWF0ZUdlb21ldHJ5KCksIHRoaXMuX21hdGVyaWFsKTtcbiAgICAgICAgdGhpcy5hZGQobWVzaCwgJ2N1YmUnKTtcbiAgICAgICAgdGhpcy5ncm91cC5wb3NpdGlvbi56ID0gLTIwO1xuICAgICAgICB0aGlzLnR3ZWVuZXIgPSBuZXcgVHdlZW4odGhpcyk7XG5cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzMikge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBtZXNoLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMzAwMFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyLmFuaW1hdGVDb2xvciggMHhmZjAwMDAsIDB4MDBmZjAwLCBwcm9wcyApO1xuICAgICAgICAgICAgICAgIHRoaXMudHdlZW5lci5hbmltYXRlUG9zaXRpb24oIG5ldyBUSFJFRS5WZWN0b3IzKDAsMCwwKSwgbmV3IFRIUkVFLlZlY3RvcjMoMTAsNiwzKSwgcHJvcHMgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogb24gcmVuZGVyXG4gICAgICogQHBhcmFtIHRpbWVcbiAgICAgKi9cbiAgICBvblJlbmRlcih0aW1lKSB7XG4gICAgICAgIHRoaXMuZ3JvdXAucm90YXRpb24ueSArPSAuMDE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY3JlYXRlIGdsb2JlIGdlb21ldHJ5XG4gICAgICogQHJldHVybnMge1RIUkVFLkljb3NhaGVkcm9uR2VvbWV0cnl9XG4gICAgICovXG4gICAgY3JlYXRlR2VvbWV0cnkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVEhSRUUuQ3ViZUdlb21ldHJ5KDUsIDUsIDUsIDEwLCAxMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY3JlYXRlIGdsb2JlIG1hdGVyaWFsXG4gICAgICovXG4gICAgY3JlYXRlTWF0ZXJpYWwoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe1xuICAgICAgICAgICAgY29sb3IgICAgICA6ICAweGZmMDAwMCxcbiAgICAgICAgICAgIHNoaW5pbmVzcyAgOiAgMTAsXG4gICAgICAgICAgICBzaGFkaW5nICAgIDogIFRIUkVFLkZsYXRTaGFkaW5nLFxuICAgICAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICAgICAgICBvcGFjaXR5ICAgIDogMVxuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgQmFzZUdyb3VwIGZyb20gJy4uLy4uL25vZGVfbW9kdWxlcy9tYWNneXZyL3NyYy9iYXNlZ3JvdXAuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUZXN0U2NlbmUgZXh0ZW5kcyBCYXNlR3JvdXAge1xuICAgIC8qKlxuICAgICAqIG9uIGNyZWF0ZSBzY2VuZSAob3IgZWFybGllc3QgcG9zc2libGUgb3Bwb3J0dW5pdHkpXG4gICAgICovXG4gICAgb25DcmVhdGUoKSB7XG4gICAgfVxuXG4gICAgb25KU09OU2NlbmVMb2FkZWQoc2NlbmUpIHtcbiAgICAgICAgc3VwZXIub25KU09OU2NlbmVMb2FkZWQoc2NlbmUpO1xuICAgICAgICB0aGlzLl9jdWJlID0gc2NlbmUuZ2V0T2JqZWN0QnlOYW1lKCdCb3ggMScpO1xuICAgICAgICB0aGlzLl9zcGhlcmUgPSBzY2VuZS5nZXRPYmplY3RCeU5hbWUoJ1NwaGVyZSAyJyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIG9uIHJlbmRlclxuICAgICAqIEBwYXJhbSB0aW1lXG4gICAgICovXG4gICAgb25SZW5kZXIodGltZSkge1xuICAgIH1cbn1cbiJdfQ=="}